<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Final Map</title>
		<link rel="stylesheet" href="src/nav/main.css">
		<style>
		/* Add fade-in and fade-out animations */
		.fade-in {
			animation: fadeIn 0.5s forwards;
		}

		.fade-out {
			animation: fadeOut 0.5s forwards;
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
			}
			to {
				opacity: 1;
			}
		}

		@keyframes fadeOut {
			from {
				opacity: 1;
			}
			to {
				opacity: 0;
			}
		}

		</style>
	</head>
	<body>

		<div class="search-container">
			<input type="text" id="searchBar" placeholder="Search dorms, colleges, or facilities...">
		</div> 

		
		

	<!-- Loading Screen -->
	<div id="loadingScreen">Loading, please wait...</div>

	<!-- Welcome Screen -->
	<div id="welcomeScreen">
		<img src="img/icons/aup logo.png">
		<p>WELCOME TO AUP 3D MAP:<br><br> ON EVER ONWARD!</p>
		<button id="enterButton">Enter</button>
	</div>

      <!-- This is the 3D Map -->
      <div id="experience" style=" background-color: rgba(0, 0, 0, 0.5);">
          <canvas id="experience-canvas"></canvas> 
    </div>
	<script type="importmap">
		{
		  "imports": {
			"three": "https://cdn.jsdelivr.net/npm/three@v0.175.0/build/three.module.js",
			"three/addons/": "https://cdn.jsdelivr.net/npm/three@v0.175.0/examples/jsm/"
		  }
		}
	  </script>
		  <script type="module" src="./src/main.js"></script>

    


    <div id="modelBuilding" style="display: none;" >
      <div id="backbtn">Back</div>
      <h1 id="buildingtitle"></h1>
      <div class="buildingSummary">
        <div class="buidlingImage"><img id="buildingImg" src="img/college_img/com.jpg"></div>
        <p id="buildingSummary"> 
          
        </p>
      </div>
    </div>

    <div id="building" style="display: none;">
      <canvas id="building-canva"></canvas>
    </div>

	<div id="dorm" style="display: none;">
		<h3>Men's Dorm</h3>
		<div class="collegelist">
			<div id="mahoganyli" class="cdfList"><span>Mahogany</span></div>
			<div id="acaciali" class="cdfList"><span>Acacia Residence Hall</span></div>
			<div id="aptfli" class="cdfList"><span>Apartment F</span></div>
			<div id="easternli" class="cdfList"><span>Eastern Residence Hall</span></div>
			<div id="molaveli" class="cdfList"><span>Molave</span></div>
			<div id="aptali" class="cdfList"><span>Apartment As</span></div>
		</div>
	
		<h3>Ladies' Dorm</h3>
		<div class="collegelist">
			<div id="sampali" class="cdfList"><span>Sampaguita Hall</span></div>
			<div id="cadenali" class="cdfList"><span>Cadena De Amor Hall</span></div>
			<div id="damali" class="cdfList"><span>Dama De Noche</span></div>
			<div id="catli" class="cdfList"><span>Cattleya</span></div>
			<div id="walingli" class="cdfList"><span>Waling-Waling Residence Hall</span></div>
			<div id="ilangli" class="cdfList"><span>Ilang-Ilang</span></div>
		</div>
	
		<h3>Family / Graduate</h3>
		<div class="collegelist">
			<div id="aptbli" class="cdfList"><span>Apartment B</span></div>
			<div id="aptgli" class="cdfList"><span>Apartment G</span></div>
			<div id="apthli" class="cdfList"><span>Apartment H</span></div>
			<div id="apteli" class="cdfList"><span>Apartment E</span></div>
		</div>
	</div>
		<div id="college" style="display: none;">
			<h3>College Buildings</h3>
			<div class="collegelist">
				<div id="cahli" class="cdfList"><span>College of Arts and Humanities</span></div>
				<div id="cobli" class="cdfList"><span>College of Business</span></div>
				<div id="codli" class="cdfList"><span>College of Dentistry</span></div>
				<div id="coeli" class="cdfList"><span>College of Education</span></div>
				<div id="cohli" class="cdfList"><span>College of Health</span></div>
				<div id="comli" class="cdfList"><span>College of Medicine</span></div>
				<div id="conli" class="cdfList"><span>College of Nursing</span></div>
				<div id="cstli" class="cdfList"><span>College of Science and Technology</span></div>
				<div id="cotli" class="cdfList"><span>College of Theology</span></div>
			</div>
		</div>

		<div id="faci" style="display: none;">
			<h2 style="text-align: center; margin-bottom: 20px;">AUP Facilities</h2>
			<div class="collegelist">
				<div id="foodfac" class="cdfList"><span>AUP Food Factory</span></div>
				<div id="clinic" class="cdfList"><span>AUP Health Service</span></div>
				<div id="store" class="cdfList"><span>AUP Store</span></div>
				<div id="waterstation" class="cdfList"><span>AUP Water Station</span></div>
				<div id="guidance" class="cdfList"><span>Guidance Service Center</span></div>
				<div id="kubo" class="cdfList"><span>Kubo</span></div>
				<div id="psd" class="cdfList"><span>Public Safety Department</span></div>
				<div id="ssc" class="cdfList"><span>Student Service Center</span></div>
				<div id="Library" class="cdfList"><span>AUP Library</span></div>
			</div>
		</div>
	<script type="module" src="./src/nav/actionButton.js"></script>


  <!-- This is the Navigation -->
  <div id="sidebar" class="sidebar col-lg-3 col-md-6">
    <button id="collegebar">üè´ College Buildings</button>
    <button id="dormbar">üè¢ Dormitories</button>
    <button id="facilitybar">üè† Facilities</button>
  </div>

  <!-- Instruction Box -->
	<div id="instructionBox">
		Hold <strong>left click</strong> and drag the mouse to rotate around the map.<br>
		Hold <strong>right click</strong> and drag the mouse to explore the map.
	</div>

	<!-- Info Button -->
	<button id="infoButton">i</button>

	<!-- Watch Video Button -->
	<button id="watchVideoButton">‚ñ∂</button>

	<!-- Video Modal -->
	<div id="videoModal">
		<button id="videoModalClose">√ó</button>
		<iframe src="" id="videoIframe" allow="autoplay; encrypted-media" allowfullscreen></iframe>
	</div>

    <script> 
      const isMobile = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    
      if (isMobile) {
        window.location.href = "src/nav/noWeb.html";
      }
    </script>

		<script>
		// Simulate building rendering and hide the loading screen after rendering is complete
		function renderBuildings() {
			return new Promise((resolve) => {
				// Simulate a delay for rendering buildings (e.g., 3 seconds)
				setTimeout(() => {
					resolve();
				}, 3000); // Adjust this duration as needed
			});
		}

		// Show the instruction box after the loading screen is hidden
		window.addEventListener("load", async () => {
			const loadingScreen = document.getElementById("loadingScreen");
			const welcomeScreen = document.getElementById("welcomeScreen");
			const enterButton = document.getElementById("enterButton");
			const instructionBox = document.getElementById("instructionBox");
			const infoButton = document.getElementById("infoButton");

			// Wait for buildings to render
			await renderBuildings();

			// Hide the loading screen
			loadingScreen.style.display = "none";

			// Show the welcome screen
			welcomeScreen.style.display = "flex";

			// Show the instruction box
			instructionBox.style.display = "block";

			// Hide the welcome screen and instruction box when the enter button is clicked
			enterButton.addEventListener("click", () => {
				welcomeScreen.style.display = "none";
				instructionBox.style.display = "none";
				infoButton.style.display = "flex"; // Show the info button
			});

			// Toggle the instruction box visibility when the info button is clicked
			infoButton.addEventListener("click", () => {
				instructionBox.style.display = "block";
				infoButton.style.display = "none"; // Hide the info button

				// Add a click listener to hide the instruction box when clicking outside
				document.addEventListener("click", function hideInstructionBox(event) {
					if (!instructionBox.contains(event.target) && event.target !== infoButton) {
						instructionBox.style.display = "none";
						infoButton.style.display = "flex"; // Show the info button again
						document.removeEventListener("click", hideInstructionBox); // Remove the listener
					}
				});
			});
		});

		// Add fade-in and fade-out functionality
		function togglePanel(panelId) {
			const panel = document.getElementById(panelId);
			const allPanels = document.querySelectorAll('.collegelist');

			// Hide all panels
			allPanels.forEach((p) => {
				if (p !== panel && p.style.display === 'block') {
					p.classList.remove('fade-in');
					p.classList.add('fade-out');
					setTimeout(() => (p.style.display = 'none'), 500);
				}
			});

			// Show the selected panel
			if (panel.style.display === 'none' || panel.style.display === '') {
				panel.style.display = 'block';
				panel.classList.remove('fade-out');
				panel.classList.add('fade-in');

				// Add click listener to hide the panel when clicking outside
				setTimeout(() => {
					document.addEventListener('click', function hidePanel(event) {
						if (!panel.contains(event.target) && event.target.id !== `${panelId}bar`) {
							panel.classList.remove('fade-in');
							panel.classList.add('fade-out');
							setTimeout(() => (panel.style.display = 'none'), 500);
							document.removeEventListener('clissck', hidePanel);
						}
					});
				}, 0); // Delay to ensure the click event doesn't immediately trigger
			}
		}

		// Attach event listeners to sidebar buttons
		document.getElementById('collegebar').addEventListener('click', () => togglePanel('college'));
		document.getElementById('dormbar').addEventListener('click', () => togglePanel('dorm'));
		document.getElementById('facilitybar').addEventListener('click', () => togglePanel('faci'));

		// Watch Video Button Functionality
		const watchVideoButton = document.getElementById('watchVideoButton');
		const videoModal = document.getElementById('videoModal');
		const videoIframe = document.getElementById('videoIframe');
		const videoModalClose = document.getElementById('videoModalClose');

		watchVideoButton.addEventListener('click', () => {
			videoIframe.src = "https://www.youtube.com/embed/Nb5Cz-ayBx4"; // Updated video URL
			videoModal.style.display = "flex";
		});

		videoModalClose.addEventListener('click', () => {
			videoIframe.src = ""; // Stop the video
			videoModal.style.display = "none";
		});
	</script>
    
	<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>

	</body>
</html>
